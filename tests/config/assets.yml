---
settings:
  chains:
    relay_chain: &relay_chain kusama
    assets_parachain: &assets_parachain statemine
  variables:
    signer: &signer "//Alice"
    asset_id: &asset_id 8
    admin: &admin 5FLSigC9HGRKVhB9FiEo4Y3koPsNmBmLJbpXg2mp1hXcS59Y #Charlie
    existencial_deposit: &ed 1000000
  decodedCalls:
    transfer_balance:
      chain: statemine
      pallet: balances
      call: transfer
      args: [ *admin, *ed ]

tests:
  - name: Assets
    before: []
    beforeEach: [] 
    after: []
    afterEach: []
    its: []
    describes:
      - name: Create
        before:
          - customs:
              - path: ./assets/custom_before.ts
                args: [ *admin, *ed ]
            extrinsics:
              - chain: *relay_chain
                signer: *signer
                pallet: balances
                call: transfer
                args: [ *admin, *ed ]
                events:
                  - name: balances.Transfer
                queries:
                  balance_A:
                    chain: *assets_parachain
                    pallet: assets
                    call: asset
                    args:
                      - *asset_id
        its:
          - name: Should create the asset
            extrinsics:
              - chain: *assets_parachain
                signer: *signer
                pallet: assets
                call: create
                args: [ *asset_id, Id: *admin, *ed ]
                events:
                  - name: assets.Created
                    attribute:
                      type: u32
                      value: *asset_id
                queries:
                  balance_B:
                    chain: *assets_parachain
                    pallet: balances
                    call: account
                    args:
                      - *admin   
            asserts:
              - type: equal
                args: [ balance_B, balance_A ]
              - type: custom
                path: "./tests/asserts/"
                args: [ *ed ]
        describes:
          - name: Nested
            after:
              - extrinsics:
                  - chain: *relay_chain
                    signer: *signer
                    pallet: balances
                    call: transfer
                    args: [ *admin, *ed ]
                    events:
                      - name: balances.Transfer
                    queries:
                      balance_A:
                        chain: *assets_parachain
                        pallet: assets
                        call: asset
                        args:
                          - 100
            its:
              - name: Should create the asset nested
                extrinsics:
                  - chain: *assets_parachain
                    signer: //Charlie
                    pallet: assets
                    call: create
                    args: [ 9, Id: *admin, *ed ]
                    events:
                      - chain: *assets_parachain
                        name: assets.Created
                        attribute:
                          type: u32
                          value: 10
                    queries:
                      balance_B:
                        chain: *assets_parachain
                        pallet: balances
                        call: account
                        args:
                          - *admin   
  - name: "Custom"
    custom:
      path: "./tests/new/extra.ts"
      args: []