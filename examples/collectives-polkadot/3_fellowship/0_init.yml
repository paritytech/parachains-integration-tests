---
settings:
  chains:
    relay_chain: &relay_chain
      wsPort: 9700
    collectives_parachain: &collectives_parachain
      wsPort: 9710
      paraId: &cp_id 1001
  variables:
    proposal_index: &proposal_index 1
    chains:
      accounts:
        alice_signer: &alice_signer //Alice
        bob_signer: &bob_signer //Bob

# original call "0x630001000100a50f03082f000006030700863ba101821a060045022802103f04d43593c715fdd31c61141abd04a99fd6822c8558854ccde39a5684e7a56da27d3f05d43593c715fdd31c61141abd04a99fd6822c8558854ccde39a5684e7a56da27d01003f05d43593c715fdd31c61141abd04a99fd6822c8558854ccde39a5684e7a56da27d02003f05d43593c715fdd31c61141abd04a99fd6822c8558854ccde39a5684e7a56da27d0300"

tests:
  - name: Fellowship
    describes:
      - name: Init the Fellowship
        its:
          - name: Note preimage from init fellowship call
            actions:
              - extrinsics:
                - chain: *relay_chain
                  signer: *alice_signer
                  pallet: preimage
                  call: notePreimage
                  args: [ # TODO expand
                    "0x630001000100a50f03142f0000060303002f6859419c883f04d43593c715fdd31c61141abd04a99fd6822c8558854ccde39a5684e7a56da27d060303002f6859419c903f05d43593c715fdd31c61141abd04a99fd6822c8558854ccde39a5684e7a56da27d0100060303002f6859419c903f05d43593c715fdd31c61141abd04a99fd6822c8558854ccde39a5684e7a56da27d0200060303002f6859419c903f05d43593c715fdd31c61141abd04a99fd6822c8558854ccde39a5684e7a56da27d0300"
                  ]
                  events:
                    - name: preimage.Noted
          - name: Submit a proposal to init the Fellowship
            actions:
              - extrinsics:
                - chain: *relay_chain
                  signer: *alice_signer
                  pallet: referenda
                  call: submit
                  args: [
                    {
                      "Origins": "FellowshipAdmin",
                    },
                    {
                      "Lookup": { # TODO obtain from the call
                        "hash_": "0xfe5e8dfe00aabb6cd7a824593a89006a9a3440479158380ccae37c058f8298e3",
                        "len": 195, # old 172
                      },
                    },
                    {
                      "After": 1, 
                    },
                  ]
                  events:
                    - name: referenda.Submitted
          - name: Alice Vote Aye
            actions:
              - extrinsics:
                - chain: *relay_chain
                  signer: *alice_signer
                  pallet: convictionVoting
                  call: vote
                  args: [
                    *proposal_index,
                    {
                      "Standard": {
                        "vote": {
                          "aye": true,
                          "conviction": "Locked1x",
                        },
                        "balance": 200000000000000,
                      }
                    },
                  ] # TODO no Aye event to catch
          - name: Bob Vote Aye
            actions:
              - extrinsics:
                - chain: *relay_chain
                  signer: *bob_signer
                  pallet: convictionVoting
                  call: vote
                  args: [
                    *proposal_index,
                    {
                      "Standard": {
                        "vote": {
                          "aye": true,
                          "conviction": "Locked1x",
                        },
                        "balance": 200000000000000,
                      }
                    },
                  ] # TODO no Aye event to catch
          - name: Submit the decision deposit
            actions:
              - extrinsics:
                - chain: *relay_chain
                  signer: *alice_signer
                  pallet: referenda
                  call: placeDecisionDeposit
                  args: [
                    *proposal_index,
                  ]
                  events:
                    - name: referenda.DecisionDepositPlaced
                    - name: fellowshipCollective.MemberAdded
                      chain: *collectives_parachain
