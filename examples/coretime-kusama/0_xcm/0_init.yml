---
settings:
  chains:
    relay_chain: &relay_chain
      wsPort: 9900
    coretime_parachain: &coretime_parachain
      wsPort: 9910
      paraId: &cp_id 1000
  variables:
    common:
      xcm_version: &xcm_version 3
      require_weight_at_most: &weight_at_most {refTime: 1000000000, proofSize: 200000}
      weight_threshold:  &weight_threshold { refTime: [30, 30], proofSize: [30, 30] }
    chains:
      relay_chain:
        signer: &rc_signer //Alice
        coretime_parachain_destination: &cp_dest { v3: { 0, interior: { x1: { parachain: *cp_id }}}}
    decodedCalls:
        cp_force_xcm_version:
            chain: *coretime_parachain
            pallet: polkadotXcm
            call: forceXcmVersion
            args: [
            { # location
                parents: 1,
                interior: Here
            },
            *xcm_version # xcmVersion
            ]
tests:
  - name: Initialize Chains
    its:
      - name: XCM supported versions between chains
        actions:
          - extrinsics: # Relay Chain sets supported version for Coretime Parachain
              - chain: *relay_chain
                sudo: true
                signer: *rc_signer
                pallet: xcmPallet
                call: forceXcmVersion
                args: [
                  { # location
                    parents: 0,
                    interior: {
                      X1: {
                        Parachain: *cp_id
                      }
                    }
                  },
                  *xcm_version # xcmVersion
                ]
                events:
                  - name: sudo.Sudid
                    result: { sudoResult: Ok }
                  - name: xcmPallet.SupportedVersionChanged
                    result: { location: { parents: 0, interior: { X1: { Parachain: &cp_id }}}, version: *xcm_version }